# Disable sandbox for docker build (it is already sandboxed anyway and the second sandbox attempt fails)
FEATURES="${FEATURES} -ipc-sandbox"
FEATURES="${FEATURES} -network-sandbox"
FEATURES="${FEATURES} -pid-sandbox"
FEATURES="${FEATURES} -sandbox"
FEATURES="${FEATURES} -usersandbox"

# We don't need to spend time building and running tests.  They frequently fail in unprivileged container builds anyway.
FEATURES="${FEATURES} -test"
BINPKG_COMPRESS="zstd"

# Compile settings
_COMMON_FLAGS="-O1 -pipe"
CFLAGS="${_COMMON_FLAGS}"
CXXFLAGS="${_COMMON_FLAGS}"
FCFLAGS="${_COMMON_FLAGS}"
FFLAGS="${_COMMON_FLAGS}"

USE="${USE} -X"
USE="${USE} -abi_x86_32"
USE="${USE} -accessibility"
USE="${USE} -bash-completion"
USE="${USE} -bluetooth"
USE="${USE} -branding"
USE="${USE} -doc"
USE="${USE} -examples"
USE="${USE} -gold"
USE="${USE} -iso"
USE="${USE} -libffi" # TODO: for some reason LLVM won't compile with libffi on

# We don't need ncurses in this build phase.  It's useful in the general case, but it is a finicky and time consuming
# build at the best of times and we are going to rebuild with it later anyway.
USE="${USE} -ncurses"
# It isn't clear from the docs what the exact method is to make LLVM **NOT** target all architectures ever.
# In this phase I am only interested in X86 (which includes X86_64)
LLVM_TARGETS="X86"
ABI_X86="64"
USE="${USE} -llvm_targets_AArch64"
USE="${USE} -llvm_targets_AMDGPU"
USE="${USE} -llvm_targets_ARM"
USE="${USE} -llvm_targets_AVR"
USE="${USE} -llvm_targets_BPF"
USE="${USE} -llvm_targets_Hexagon"
USE="${USE} -llvm_targets_Lanai"
USE="${USE} -llvm_targets_MSP430"
USE="${USE} -llvm_targets_Mips"
USE="${USE} -llvm_targets_NVPTX"
USE="${USE} -llvm_targets_PowerPC"
USE="${USE} -llvm_targets_RISCV"
USE="${USE} -llvm_targets_Sparc"
USE="${USE} -llvm_targets_SystemZ"
USE="${USE} -llvm_targets_VE"
USE="${USE} -llvm_targets_WebAssembly"
USE="${USE} -llvm_targets_XCore"

USE="${USE} -man"
USE="${USE} -sanitize" # It seems this needs to be off according to the clang profile.  Not sure why.
USE="${USE} -sqlite"
USE="${USE} -systemd"
USE="${USE} -test"
USE="${USE} binutils-plugin"
USE="${USE} compiler-rt"
USE="${USE} curl_ssl_openssl"
USE="${USE} default-compiler-rt"
USE="${USE} default-lld"
USE="${USE} libunwind"
USE="${USE} llvm-libunwind"
USE="${USE} runtime"
USE="${USE} ssl"



PORTDIR="/var/db/repos/gentoo"
DISTDIR="/var/cache/distfiles"
PKGDIR="/var/cache/binpkgs"

LC_MESSAGES=C
